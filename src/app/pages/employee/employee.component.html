<div class="d-flex align-items-center font-weight-bold my-2 "  >
  <span class="navi-icon" routerLink="/settings"><i style="font-size: 25px;color: #483d8b;" class="flaticon2-gear"></i></span> &nbsp;&nbsp;
  <a   class="navi-text" routerLink="/settings">Back To Settings</a > </div>

<div class="card card-custom gutter-b">
    <div class="card-header">
        <div class="card-title">
            <h3 class="card-label">Users</h3>
        </div>
        <!-- <div class="card-toolbar">
            <button type="button" class="btn btn-primary" (click)="editModal()">Add</button>

        </div> -->

        <div class=" row">
          <div class="col-8" [formGroup]="searchGroup">
            <div class="card-toolbar">
            <!-- <small class="form-text text-muted"><b>Search</b> in all fields</small> -->
           
              <div class="form-group has-search">
                <span class="fa fa-search form-control-feedback"></span>
                <input type="text" class="form-control" name="searchText" placeholder="Search" value=""
                formControlName="searchTerm" />
              </div>
          </div>
          </div>
            <div class="col-4">
              <div class="card-toolbar">
                <button type="button" class="btn btn-primary" (click)="editModal()">+ Add</button>
          
              </div>
            </div> 
        </div>
    </div>
    <div class="card-body">
        <!-- begin: Filtration form -->
        <!-- <div class="form form-label-right">
          <div class="form-group row">
            <div class="col-lg-4">
              <div class="row" [formGroup]="filterGroup">
                <div class="col-lg-6">
                  <select class="form-control" name="status" placeholder="Filter by Status" formControlName="status">
                    <option value="">All</option>
                    <option value="1">Susspended</option>
                    <option value="2">Active</option>
                    <option value="3">Pending</option>
                  </select><small class="form-text text-muted"><b>Filter</b> by Status</small>
                </div>
                <div class="col-lg-6">
                  <select class="form-control" placeholder="Filter by Type" name="type" formControlName="type">
                    <option value="">All</option>
                    <option value="1">Business</option>
                    <option value="2">Individual</option>
                  </select><small class="form-text text-muted"><b>Filter</b> by Type</small>
                </div>
              </div>
            </div>
            <div class="col-lg-2" [formGroup]="searchGroup">
              <input type="text" class="form-control" name="searchText" placeholder="Search" value=""
                formControlName="searchTerm" /><small class="form-text text-muted"><b>Search</b> in all fields</small>
            </div>
          </div>
        </div> -->
        <!-- end: Filtration form -->

        <!-- begin: Grouping -->
        <!-- <ng-container *ngIf="grouping.getSelectedRowsCount()"> -->
        <!-- <div class="form">
            <div class="row align-items-center form-group-actions margin-top-20 margin-bottom-20">
              <div class="col-xl-12">
                <div class="form-group form-group-inline">
                  <div class="form-label form-label-no-wrap">
                    <label class="font-bold font-danger"><span>Selected records count:
                        <b>{{ grouping.getSelectedRowsCount() }}</b></span></label>
                  </div>
                  <div>
                    <button type="button" class="btn btn-danger font-weight-bolder font-size-sm mr-1"
                      (click)="deleteSelected()">
                      <i class="fa fa-trash"></i> Delete All
                    </button>&nbsp;
                    <button type="button" class="btn btn-light-primary font-weight-bolder font-size-sm mr-1"
                      (click)="fetchSelected()">
                      <i class="fa fa-stream"></i> Fetch Selected
                    </button>&nbsp;
                    <button type="button" class="btn btn-light-primary font-weight-bolder font-size-sm mr-1"
                      (click)="updateStatusForSelected()">
                      <i class="fa fa-sync-alt"></i> Update Status
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div> -->
        <!-- </ng-container> -->
        <!-- end: Grouping -->

        <!-- begin:Table -->
        <div class="table-responsive angular-bootstrap-table">
            <table class="table table-head-custom table-vertical-center overflow-hidden">
                <thead>
                    <!-- <th class="selection-cell-header" data-row-selection="true">
                <label class="checkbox checkbox-single"><input type="checkbox" (click)="grouping.selectAllRows()"
                    [checked]="grouping.checkAreAllRowsSelected()" /><span></span></label>
              </th> -->
                    <th>
                        ID
                        <app-sort-icon column="id" [activeColumn]="sorting.column" [activeDirection]="sorting.direction"
                  (sort)="sort($event)"></app-sort-icon>
                    </th>
                    <th>
                        FIRST NAME
                        <app-sort-icon column="firstname" [activeColumn]="sorting.column" [activeDirection]="sorting.direction"
                        (sort)="sort($event)"></app-sort-icon>
                    </th>
                    <th>
                      LAST NAME
                      <app-sort-icon column="lastname" [activeColumn]="sorting.column" [activeDirection]="sorting.direction"
                      (sort)="sort($event)"></app-sort-icon>
                      
                  </th>
                  <th>
                    EMAIL
                    <app-sort-icon column="email" [activeColumn]="sorting.column" [activeDirection]="sorting.direction"
                    (sort)="sort($event)"></app-sort-icon>
                  </th>
                    
                    <th>ACTIONS</th>
                </thead>
                <tbody>
                 
                    <tr *ngFor="let employee of employeeService.items$ | async">
                <!-- <td class="selection-cell">
                  <label class="checkbox checkbox-single"><input type="checkbox" (click)="grouping.selectRow(customer.id)"
                      [checked]="grouping.isRowSelected(customer.id)" />
                    <span></span>
                  </label>
                </td> -->
                <td *ngIf="user.id !=employee.id">{{ employee.id }}</td>
                <td *ngIf="user.id !=employee.id">{{ employee.firstname }}</td>
                <td *ngIf="user.id !=employee.id">{{ employee.lastname }}</td>
                <td *ngIf="user.id !=employee.id">{{ employee.email }}</td> 
                <!-- <td>
                  <span class="label label-lg label-inline" [class.label-light-danger]="customer.status === 1"
                    [class.label-light-success]="customer.status === 2" [class.label-light-primary]="customer.status === 3">
                    <ng-container *ngIf="customer.status === 1">Suspended</ng-container>
                    <ng-container *ngIf="customer.status === 2">Active</ng-container>
                    <ng-container *ngIf="customer.status === 3">Pending</ng-container>
                  </span>
                </td> -->
                <!-- <td>
                  <span class="label label-dot label-primary mr-2" [class.label-success]="customer.type === 1"
                    [class.label-primary]="customer.type === 2"></span>&nbsp;<span class="font-bold font-primary">
                    <ng-container *ngIf="customer.type === 1">Business</ng-container>
                    <ng-container *ngIf="customer.type === 2">Individual</ng-container>
                  </span>
                </td> -->
                <td *ngIf="user.id !=employee.id">
    
                  <a title="Edit User" class="btn btn-icon btn-light btn-hover-primary btn-sm mx-3"
                    (click)="editUser(employee)">
                    <span [inlineSVG]="'./assets/media/svg/icons/Communication/Write.svg'" cacheSVG="true"
                      class="svg-icon svg-icon-md svg-icon-primary">
                    </span>
                  </a>
    
                  <a title="Delete User" class="btn btn-icon btn-light btn-hover-danger btn-sm"
                    (click)="editDelete(employee)">
                    <span [inlineSVG]="'./assets/media/svg/icons/General/Trash.svg'" cacheSVG="true"
                      class="svg-icon svg-icon-md svg-icon-danger">
                    </span>
                  </a>
                </td>
              </tr>
                </tbody>
            </table>
        </div>
        <!-- end: Table -->
        <!-- <app-paginator class="d-flex justify-content-between align-items-center flex-wrap" [paginator]="paginator"
          [isLoading]="isLoading" (paginate)="paginate($event)"></app-paginator> -->
    </div>
</div>



<!-- Add Employee Modal -->

<ng-template #openModal let-modal>

    <div class="modal-header cust-color">
        <div class="modal-title h4" id="example-modal-sizes-title-lg">
          <!-- <ng-container *ngIf="customer">
            <ng-container *ngIf="customer.id">Edit</ng-container>
            <ng-container *ngIf="!customer.id">Create</ng-container>
         
            <ng-container *ngIf="customer.id">'{{customer.firstName}} {{ customer.lastName }}'</ng-container>
          </ng-container> -->
         
          <span style="color:aliceblue;"> <i class="fa fa-plus-circle" aria-hidden="true"></i>  Add User</span>

        </div>
      </div>
    <div class="demo-tab-content">
        <div class="overlay overlay-block cursor-default modal-body" style="min-height: 320px;">
            <!-- <ng-container *ngIf="isLoading$ | async">
                <div class="overlay-layer bg-transparent">
                    <div class="spinner spinner-lg spinner-success"></div>
                </div>
            </ng-container> -->

            <ng-container>
                <form action="#" class="form form-label-right" [formGroup]="formGroup"> 
                
                    <div class="row">
                      <div class="col-6"> 
                        <div class="form-group cust-height"  >
                          <label class="form-label"> First Name</label>
                          <input type="text" class="form-control form-control-lg form-control-solid"
                              name="firstName" placeholder="Enter First Name" autocomplete="off"
                              [class.is-invalid]="isControlInvalid('firstname')"
                                formControlName="firstname" />
                          <!-- <div class="valid-feedback" *ngIf="isControlValid('firstName')">First name was entered
                              correct</div> -->
                          <div class="invalid-feedback"  *ngIf="controlHasError('required', 'firstname')">First
                              name is required</div> 
                      </div> 
                    </div>
                    <div class="col-6">  
                      <div class="form-group cust-height">
                        <label class="form-label">Last Name</label>
                        <input type="text" class="form-control form-control-lg form-control-solid"
                            name="lastName" placeholder="Enter Last Name" autocomplete="off"
                            [class.is-invalid]="isControlInvalid('lastname')"
                              formControlName="lastname" />
                        <!-- <div class="valid-feedback" *ngIf="isControlValid('lastName')">Last name was entered
                            correct</div> -->
                        <div class="invalid-feedback" *ngIf="controlHasError('required', 'lastname')">Last name
                            is required</div> 
                    </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-6">
                        <div class="form-group cust-height">
                          <label class="form-label"> Email</label>
                          <input type="email" class="form-control form-control-lg form-control-solid" name="email"
                              placeholder="Enter Email" autocomplete="off"
                              [class.is-invalid]="isControlInvalid('email')"
                                formControlName="email" />
                          <!-- <div class="valid-feedback" *ngIf="isControlValid('email')">Email was entered correct
                          </div> -->
                          <div class="invalid-feedback" *ngIf="controlHasError('required', 'email')">Email is
                              required</div>
                          <div class="invalid-feedback" *ngIf="controlHasError('email', 'email')">Email format is
                              incorrect</div>
                      </div>
                      </div>
                      <div class="col-6">
                        <div class="form-group cust-height">
                          <label class="form-label">Password</label>
                          <input type="text" class="form-control form-control-lg form-control-solid"
                              name="jobTitle" placeholder="Enter Password" autocomplete="off"
                              [class.is-invalid]="isControlInvalid('password')"
                               formControlName="password" />
                          <!-- <div class="valid-feedback" *ngIf="isControlValid('jobTitle')">Job Title was entered
                              correct</div> -->
                          <div class="invalid-feedback" *ngIf="controlHasError('required', 'password')">Password
                              is required</div>
                      </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-6">
                        <label class="form-label">User Role</label>

                        <mat-form-field>
                          <mat-select (selectionChange)="selectRole($event.value)" [class.is-invalid]="isControlInvalid('userRole')" formControlName="userRole" name="userRole"  placeholder="Select Role" >
                             <mat-option>
                              <ngx-mat-select-search  [formControl]="userMultiFilterCtrl" [searching]="searching"></ngx-mat-select-search>
                            </mat-option>
                            <mat-option  *ngFor="let role of filteredUserMulti | async" [value]="role.roleName">
                              {{role.roleName}}
                            </mat-option>
                          </mat-select>
                        </mat-form-field> 
                          <div class="invalid-feedback" *ngIf="controlHasError('required', 'userRole')"> Role is required </div>
        
                      </div> 
                      <div class="col-6"> 
                  
                      <div class="form-group cust-height">
                        <label class="form-label">Contact No</label>
                        <input type="text" (keypress)="keyPress($event)" class="form-control form-control-lg form-control-solid"
                            name="contactNo" placeholder="Enter Contact No" autocomplete="off"
                             
                             formControlName="contactNo" />
                        <!-- <div class="valid-feedback" *ngIf="isControlValid('contactNo')">Contact No was entered
                            correct</div> -->
                        <!-- <div class="invalid-feedback" *ngIf="controlHasError('required', 'contactNo')">Contact No
                            is required</div> -->
                        <div class="invalid-feedback" *ngIf="controlHasError('minlength', 'contactNo')">Contact No
                            should have at
                            least 10 digits</div>
                        <div class="invalid-feedback" *ngIf="controlHasError('maxLength', 'contactNo')">Contact No
                            should have at
                            least 10 digits</div>
                    </div>
                  </div>
                    </div>
                    <div class="row">
                      <div class="col-6"> 
                      <div class="form-group cust-height">
                        <label class="form-label">Job Title</label>
                        <input type="text" class="form-control form-control-lg form-control-solid"
                            name="jobTitle" placeholder="Enter Job Title" autocomplete="off"
                         
                            formControlName="jobTitle" />
                        <!-- <div class="valid-feedback" *ngIf="isControlValid('jobTitle')">Job Title was entered
                            correct</div> -->
                        <!-- <div class="invalid-feedback" *ngIf="controlHasError('required', 'jobTitle')">Job Title
                            is required</div> -->
                    </div>
                    </div>
                    </div>

                </form>
            </ng-container>
        </div>
       
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-light btn-elevate mr-2" (click)="closeModal()">Cancel</button>
       

        <ng-container > 
          <button type="submit" (click)="Submit()"  [ngStyle]=" {'width':isLoading$ == true ? '20%':'17%'}"  class="btn btn-custom btn-elevate"
          >Submit <span [ngClass]="{spinner:isLoading$ == true}" style="margin: 17%;"></span></button> 
      
        </ng-container>
       
    </div>

</ng-template>
<!-- Add Employee Modal -->

<!-- Update Employee Modal -->

<ng-template #openUpdateModal let-modal> 
  <div class="modal-header cust-color">
      <div class="modal-title h4" id="example-modal-sizes-title-lg">
        <!-- <ng-container *ngIf="customer">
          <ng-container *ngIf="customer.id">Edit</ng-container>
          <ng-container *ngIf="!customer.id">Create</ng-container>
       
          <ng-container *ngIf="customer.id">'{{customer.firstName}} {{ customer.lastName }}'</ng-container>
        </ng-container> -->
       
        <span style="color:aliceblue;"> <i class="fas fa-edit" aria-hidden="true"></i>  Update User</span>

      </div>
    </div>
  <div class="demo-tab-content">
      <div class="overlay overlay-block cursor-default modal-body" style="min-height: 320px;">
          <!-- <ng-container *ngIf="isLoading$ | async">
              <div class="overlay-layer bg-transparent">
                  <div class="spinner spinner-lg spinner-success"></div>
              </div>
          </ng-container> -->

          <ng-container>
              <form action="#" class="form form-label-right" [formGroup]="updateformGroup"> 
              
                  <div class="row">
                    <div class="col-6"> 
                      <div class="form-group cust-height"  >
                        <label class="form-label"> First Name</label>
                        <input type="text" class="form-control form-control-lg form-control-solid"
                            name="firstName" placeholder="Enter First Name" autocomplete="off"
                            [class.is-invalid]="isUpdateControlInvalid('firstname')"
                              formControlName="firstname" />
                        <!-- <div class="valid-feedback" *ngIf="isControlValid('firstName')">First name was entered
                            correct</div> -->
                        <div class="invalid-feedback"  *ngIf="UpdatecontrolHasError('required', 'firstname')">First
                            name is required</div> 
                    </div> 
                  </div>
                  <div class="col-6">  
                    <div class="form-group cust-height">
                      <label class="form-label">Last Name</label>
                      <input type="text" class="form-control form-control-lg form-control-solid"
                          name="lastName" placeholder="Enter Last Name" autocomplete="off"
                          [class.is-invalid]="isUpdateControlInvalid('lastname')"
                            formControlName="lastname" />
                      <!-- <div class="valid-feedback" *ngIf="isControlValid('lastName')">Last name was entered
                          correct</div> -->
                      <div class="invalid-feedback" *ngIf="UpdatecontrolHasError('required', 'lastname')">Last name
                          is required</div> 
                  </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-6">
                      <div class="form-group cust-height">
                        <label class="form-label"> Email</label>
                        <input type="email" class="form-control form-control-lg form-control-solid" name="email"
                            placeholder="Enter Email" autocomplete="off"
                            [class.is-invalid]="isUpdateControlInvalid('email')"
                              formControlName="email" />
                        <!-- <div class="valid-feedback" *ngIf="isControlValid('email')">Email was entered correct
                        </div> -->
                        <div class="invalid-feedback" *ngIf="UpdatecontrolHasError('required', 'email')">Email is
                            required</div>
                        <div class="invalid-feedback" *ngIf="UpdatecontrolHasError('email', 'email')">Email format is
                            incorrect</div>
                    </div>
                    </div>
                    <div class="col-6">
                      <div class="form-group cust-height">
                        <label class="form-label">Password</label>
                        <input type="text" class="form-control form-control-lg form-control-solid"
                            name="jobTitle" placeholder="Enter Password" autocomplete="off" 
                             formControlName="password" />
                        <!-- <div class="valid-feedback" *ngIf="isControlValid('jobTitle')">Job Title was entered
                            correct</div> -->
                        <!-- <div class="invalid-feedback" *ngIf="UpdatecontrolHasError('required', 'password')">Password
                            is required</div> -->
                    </div>
                    </div>
                
                  </div>
                  <div class="row">
                    <div class="col-6">
                      <label class="form-label">User Role</label>

                      <mat-form-field>
                        <mat-select (selectionChange)="selectRole($event.value)" [class.is-invalid]="isUpdateControlInvalid('userRole')" formControlName="userRole" name="userRole"  placeholder="Select Role" >
                           <mat-option>
                            <ngx-mat-select-search  [formControl]="userMultiFilterCtrl" [searching]="searching"></ngx-mat-select-search>
                          </mat-option>
                          <mat-option  *ngFor="let role of filteredUserMulti | async" [value]="role.roleName">
                            {{role.roleName}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field> 
                        <div class="invalid-feedback" *ngIf="UpdatecontrolHasError('required', 'userRole')"> Role is required </div>
      
                    </div> 
                    <div class="col-6"> 
                
                    <div class="form-group cust-height">
                      <label class="form-label">Contact No</label>
                      <input type="text" (keypress)="keyPress($event)"  pattern="^((\\+0?)|0)?[0-9]{10}$"   maxlength=11 minlength=11  class="form-control form-control-lg form-control-solid"
                          name="contactNo" placeholder="Enter Contact No" autocomplete="off"
                          [class.is-invalid]="isUpdateControlInvalid('contactNo')"
                           formControlName="contactNo" />
                      <!-- <div class="valid-feedback" *ngIf="isControlValid('contactNo')">Contact No was entered
                          correct</div> -->
                      <div class="invalid-feedback" *ngIf="UpdatecontrolHasError('required', 'contactNo')">Contact No
                          is required</div>
                      <div class="invalid-feedback" *ngIf="UpdatecontrolHasError('minlength', 'contactNo')">Contact No
                          should have at
                          least 11 digits</div>
                      <div class="invalid-feedback" *ngIf="UpdatecontrolHasError('maxLength', 'contactNo')">Contact No
                          should have at
                          least 11 digits</div>
                  </div>
                </div>
            
                  </div>
                 
                  <div class="row">
                    <div class="col-6"> 
                      <div class="form-group cust-height">
                        <label class="form-label">Job Title</label>
                        <input type="text" class="form-control form-control-lg form-control-solid"
                            name="jobTitle" placeholder="Enter Job Title" autocomplete="off"
                            [class.is-invalid]="isUpdateControlInvalid('jobTitle')"
                            formControlName="jobTitle" />
                        <!-- <div class="valid-feedback" *ngIf="isControlValid('jobTitle')">Job Title was entered
                            correct</div> -->
                        <div class="invalid-feedback" *ngIf="UpdatecontrolHasError('required', 'jobTitle')">Job Title
                            is required</div>
                    </div>
                    </div>
                  </div>
              </form>
          </ng-container>
      </div>
     
  </div>
  <div class="modal-footer">
      <button type="button" class="btn btn-light btn-elevate mr-2" (click)="closeModal()">Cancel</button> 
      
      <ng-container  > 
        <button type="submit" (click)="updateEmployee()"  [ngStyle]=" {'width':isLoading$ == true ? '20%':'17%'}"  class="btn btn-custom btn-elevate"
         >Update <span [ngClass]="{spinner:isLoading$ == true}" style="margin: 17%;"></span></button> 
    
      </ng-container>
  </div>

</ng-template>
<!-- Update Employee Modal -->


  <!-- Confirm Box -->
  <ng-template #confrimBox let-modal>

    <div class="modal-header ">
      <div class="modal-title h4" id="example-modal-sizes-title-lg">
        <!-- <ng-container *ngIf="customer">
            <ng-container *ngIf="customer.id">Edit</ng-container>
            <ng-container *ngIf="!customer.id">Create</ng-container>
         
            <ng-container *ngIf="customer.id">'{{customer.firstName}} {{ customer.lastName }}'</ng-container>
          </ng-container> --> 
         <span> <i class="fa fa-pencil-circle" aria-hidden="true"></i> Delete Confirmation</span>

      </div>
    </div>
    
    <!-- <div class="modal-footer">
       <ng-container> 
        <button type="submit" (click)="deleteUser()"  class="btn btn-primary btn-elevate"
         >Yes</button>

         <button type="submit" (click)="closeDelete()"  class="btn btn-primary btn-elevate"
           >No</button>
      </ng-container> 
    </div> -->
    <div class="modal-body">
      <!-- <ng-container *ngIf="isDeleting">
       <h4>User is deleting...</h4>
      </ng-container> -->
    
      <ng-container  >
      <h4>Are you sure to  delete this user?</h4>
      </ng-container>
    </div>
    
    <div class="modal-footer">
       <!-- <ng-container> 
      
  
         <div class="text-center">
          <button class="btn btn-danger" (click)="deleteUser()" data-entity="user" id="userDeleteButton"><span class="fa fa-trash"></span> Delete</button>
        </div>
  
       
  
           <button type="button" (click)="closeDelete()"  class="btn btn-default" data-dismiss="modal">Cancel</button>
      </ng-container> -->

      <ng-container>
 
        <button class="btn btn-danger" [ngStyle]=" {'width':isDeleting == true ? '25%':'20%'}" (click)="deleteUser()"
        data-entity="user" id="userDeleteButton"><span class="fa fa-trash"></span> Delete <span
          [ngClass]="{spinner:isDeleting== true}" style="margin: 10%;"></span></button>
        
        <button type="button" (click)="closeDelete()" class="btn btn-default" data-dismiss="modal">Cancel</button>
      </ng-container>
   
    </div>
  
  </ng-template>
  
  <!-- Confirm Box -->